# Калькулятор эффективности перехода на АУСН

## Обзор

Калькулятор АУСН — интерактивный инструмент для сравнения налоговых режимов с целью помочь предпринимателям оптимизировать налоговую нагрузку при переходах между существующей системой и автоматизированной упрощённой системой налогообложения (АУСН).

**Дата создания:** 11 октября 2025  
**Версия:** 1.0.0  
**Расположение:** `components/calculator-ausn/`

---

## Функциональность

### Основные возможности

- **Сравнение налоговых режимов:** УСН (6% и 15%), ОСНО, АУСН (8% и 20%)
- **Учёт всех налогов и страховых взносов:** за себя и сотрудников, включая взносы на травматизм
- **Автоматическая рекомендация** на основе рассчитанной экономии
- **Валидация по лимитам АУСН:** доход, сотрудники, регион
- **Пошаговый удобный интерфейс** с пояснениями
- **Раскрывающаяся детальная таблица** сравнения режимов
- **Ввод данных в тысячах рублей** для удобства пользователя

---

## Структура проекта

```
components/calculator-ausn/
├── calculator-config.ts      # Конфигурация, константы и функции расчёта
├── types.ts                   # TypeScript интерфейсы и типы
├── Calculator.tsx             # Главный компонент-оркестратор
├── CalculatorForm.tsx         # Форма ввода данных с валидацией
├── CalculatorResults.tsx      # Отображение результатов в карточках
├── ComparisonTable.tsx        # Детальная таблица сравнения
├── EligibilityChecker.tsx     # Проверка соответствия лимитам
├── index.ts                   # Экспорты модуля
└── README.md                  # Инструкции по обновлению
```

---

## Технические детали

### Константы налогообложения

Все константы централизованы в `calculator-config.ts`:

```typescript
export const TAX_CONSTANTS = {
  // Фиксированные взносы ИП за себя (2024-2025)
  IP_FIXED_INSURANCE: 49500,
  IP_INSURANCE_THRESHOLD: 300000,
  IP_ADDITIONAL_INSURANCE_RATE: 0.01,

  // Ставки налогов
  USN_INCOME_RATE: 0.06,           // УСН 6%
  USN_INCOME_EXPENSES_RATE: 0.15,  // УСН 15%
  USN_MIN_TAX_RATE: 0.01,          // Минимальный налог УСН 15%
  AUSN_INCOME_RATE: 0.08,          // АУСН 8%
  AUSN_INCOME_EXPENSES_RATE: 0.20, // АУСН 20%
  AUSN_MIN_TAX_RATE: 0.03,         // Минимальный налог АУСН 20%
  NDFL_RATE: 0.13,                 // НДФЛ
  PROFIT_TAX_RATE: 0.20,           // Налог на прибыль
  NDS_RATE: 0.20,                  // НДС

  // Страховые взносы
  EMPLOYEE_INSURANCE_RATE: 0.302,  // 30.2% от ФОТ
  AUSN_INJURY_RATE: 0.002,         // 0.2% на травматизм
}
```

### Лимиты АУСН

```typescript
export const AUSN_CONFIG = {
  limits: {
    maxRevenue: 60_000_000,       // 60 млн руб.
    maxEmployees: 5,              // 5 сотрудников
    maxResidualValue: 150_000_000, // 150 млн руб. (ОС)
  },
}
```

---

## Алгоритмы расчёта

### 1. УСН 6% (Доходы)

**Формула:**
```
Налог = Доходы × 6%
Взносы за себя = 49,500 + (Доходы - 300,000) × 1% (если доход > 300,000)
Взносы за сотрудников = Кол-во × Зарплата × 12 × 30.2%

Для ИП: Налог уменьшается на взносы (до 50% если есть сотрудники, до 100% если нет)
Итого = Налог + Взносы
```

**Особенности:**
- ИП может уменьшить налог на страховые взносы
- Если есть сотрудники - максимум на 50%
- Если нет сотрудников - можно уменьшить до 0

### 2. УСН 15% (Доходы минус расходы)

**Формула:**
```
Налоговая база = max(0, Доходы - Расходы)
Налог = max(Налоговая база × 15%, Доходы × 1%)  // минимум 1%
Взносы = аналогично УСН 6%

Для ИП: Взносы НЕ уменьшают налог (учитываются в расходах)
Итого = Налог + Взносы
```

**Особенности:**
- Минимальный налог - 1% от доходов
- Взносы НЕ уменьшают налог напрямую

### 3. ОСНО

**Для ИП:**
```
НДФЛ = (Доходы - Расходы) × 13%
НДС = Доходы × 20%
Взносы за себя = 49,500 + (Доходы - 300,000) × 1%
Взносы за сотрудников = Кол-во × Зарплата × 12 × 30.2%
Итого = НДФЛ + НДС + Взносы
```

**Для ООО:**
```
Налог на прибыль = (Доходы - Расходы) × 20%
НДС = Доходы × 20%
Взносы за сотрудников = Кол-во × Зарплата × 12 × 30.2%
Итого = Налог на прибыль + НДС + Взносы
```

### 4. АУСН 8% (Доходы)

**Формула:**
```
Налог = Доходы × 8%
ФОТ = Кол-во сотрудников × Зарплата × 12
Взносы = ФОТ × 0.2%  // только на травматизм
Итого = Налог + Взносы
```

**Особенности:**
- Взносы за себя НЕ платятся (включены в налог)
- Взносы за сотрудников - только на травматизм (0.2%)

### 5. АУСН 20% (Доходы минус расходы)

**Формула:**
```
Налоговая база = max(0, Доходы - Расходы)
Налог = max(Налоговая база × 20%, Доходы × 3%)  // минимум 3%
ФОТ = Кол-во сотрудников × Зарплата × 12
Взносы = ФОТ × 0.2%
Итого = Налог + Взносы
```

**Особенности:**
- Минимальный налог - 3% от доходов
- Взносы минимальные (только травматизм)

---

## Подробное описание работы калькулятора

### Пошаговый процесс расчёта

#### 1. Запрос входных параметров от пользователя

Калькулятор запрашивает следующие данные:
- **Тип бизнеса:** ИП или ООО
- **Текущая система налогообложения:** УСН 6%, УСН 15% или ОСНО
- **Годовой доход (оборот):** в тысячах рублей
- **Годовые расходы:** в тысячах рублей (учитываются для УСН 15% и ОСНО)
- **Количество сотрудников:** от 0 до 999
- **Средняя зарплата сотрудника:** в тысячах рублей в месяц
- **Подтверждение права на АУСН:** обязательный чекбокс

#### 2. Валидация входных данных

Система проверяет корректность и допустимость введённых данных:
- Доходы должны быть положительными
- Расходы не могут превышать доходы
- Количество сотрудников неотрицательное
- Если есть сотрудники, зарплата обязательна
- При нарушении выводятся конкретные сообщения об ошибках
- Расчёт блокируется до устранения ошибок

#### 3. Проверка лимитов АУСН

Перед расчётом проверяется соответствие лимитам АУСН:
- **Доход:** ≤ 60 000 000 руб. в год
- **Сотрудники:** ≤ 5 человек
- **Остаточная стоимость ОС:** ≤ 150 000 000 руб.
- **Регион:** только Москва, Московская область, Калужская область, Татарстан

При превышении лимитов выводятся предупреждения, но расчёт всё равно выполняется для информации.

#### 4. Расчёт налоговой нагрузки на текущей системе

Используются соответствующие формулы выбранного режима:
- **УСН 6%:** с учётом уменьшения налога на взносы
- **УСН 15%:** с проверкой минимального налога (1%)
- **ОСНО:** включая НДФЛ/налог на прибыль и НДС

Рассчитываются:
- Основной налог
- Страховые взносы (за себя и сотрудников)
- Итоговая сумма к уплате

#### 5. Расчёт налоговой нагрузки на АУСН

Выполняется параллельный расчёт для двух вариантов:
- **АУСН 8% (доходы):** самый простой режим
- **АУСН 20% (доходы минус расходы):** учитывает расходы

Для каждого варианта:
- Основной налог по ставке 8% или 20%
- Взносы на травматизм (0.2% от ФОТ)
- Итоговая сумма к уплате

#### 6. Сравнение результатов

Система сравнивает три варианта:
1. Текущая система
2. АУСН 8%
3. АУСН 20%

Определяется:
- Какой режим даёт наименьшую налоговую нагрузку
- Размер экономии/переплаты в рублях
- Процент экономии/переплаты

#### 7. Формирование рекомендации

На основе расчётов генерируется персонализированная рекомендация:
- **Если АУСН выгоднее:** "Переход на АУСН сократит налоги на X руб. (Y%)"
- **Если текущая система лучше:** "Текущая система оптимальна, АУСН увеличит расходы"
- **При равенстве:** "Налоговая нагрузка примерно одинаковая"

Указывается конкретный рекомендуемый режим (8% или 20%).

#### 8. Вывод результатов

Пользователю отображаются:

**А) Карточки с результатами:**
- Три карточки (текущая, АУСН 8%, АУСН 20%)
- Лучший вариант выделен зелёной рамкой и badge
- Детализация: налог + взносы = итого
- Экономия/переплата с цветовым кодированием

**Б) Раскрывающаяся детальная таблица:**
- По умолчанию свернута (заголовок-кнопка)
- При клике раскрывается полная таблица
- Показывает детальную разбивку по каждой системе
- Включает подстроки (взносы за себя, за сотрудников)
- Примечания внизу

**В) Блок с рекомендациями:**
- Текстовое описание результата
- Следующие шаги для перехода
- Информация о сроках и банках

#### 9. Действия пользователя

После получения результатов доступны:
- **Кнопка "Получить консультацию":** открывает форму обратной связи
- **Кнопка "Скачать отчёт PDF":** сохраняет результаты (планируется)
- **Кнопка "Новый расчёт":** сбрасывает форму для нового расчёта
- **Ссылки на уполномоченные банки:** для оформления АУСН

---

## UI/UX рекомендации

### Принципы дизайна

- **Пошаговое заполнение формы** с подсказками и примерами
- **Яркая индикация ошибок** с конкретными инструкциями по исправлению
- **Визуальное выделение** выбранного и рекомендуемого варианта
- **Прогрессивное раскрытие:** детали только по запросу (свёрнутая таблица)
- **Цветовое кодирование:** зелёный (экономия), красный (переплата), серый (нейтрально)

### Адаптивность

- **Desktop:** форма и результаты в две колонки
- **Tablet:** одна колонка с оптимизированной шириной
- **Mobile:** вертикальная прокрутка, кнопки на всю ширину
- **Клавиатурная навигация:** полная поддержка Tab, Enter, стрелок

### Доступность

- ARIA-метки для всех интерактивных элементов
- Достаточный контраст цветов (WCAG AA)
- Описания для скринридеров
- Фокус-индикаторы на всех элементах формы

---

## Пример тестовых расчётов

### Тест 1: ИП на УСН 6%

**Входные данные:**
- Тип: ИП
- Текущая система: УСН 6%
- Доход: 2 500 000 руб.
- Расходы: 500 000 руб.
- Сотрудники: 2 чел.
- Зарплата: 40 000 руб./мес.

**Ожидаемые результаты:**
- УСН 6%: ~150 000 руб. (с уменьшением на взносы)
- АУСН 8%: ~200 000 руб.
- АУСН 20%: ~400 000 руб.
- **Рекомендация:** оставаться на УСН 6%

### Тест 2: ООО на ОСНО

**Входные данные:**
- Тип: ООО
- Текущая система: ОСНО
- Доход: 10 000 000 руб.
- Расходы: 6 000 000 руб.
- Сотрудники: 5 чел.
- Зарплата: 70 000 руб./мес.

**Ожидаемые результаты:**
- ОСНО: ~3 800 000 руб.
- АУСН 8%: ~800 000 руб.
- АУСН 20%: ~800 000 руб.
- **Рекомендация:** переход на АУСН (экономия ~3 млн руб.)

### Тест 3: ИП на УСН 15%

**Входные данные:**
- Тип: ИП
- Текущая система: УСН 15%
- Доход: 5 000 000 руб.
- Расходы: 3 500 000 руб.
- Сотрудники: 1 чел.
- Зарплата: 50 000 руб./мес.

**Ожидаемые результаты:**
- УСН 15%: ~225 000 руб.
- АУСН 8%: ~400 000 руб.
- АУСН 20%: ~300 000 руб.
- **Рекомендация:** оставаться на УСН 15%

---

## Валидация расчётов

### Проверка формул

Все формулы проверены на соответствие:
- Налоговому кодексу РФ (глава 26.5 НК РФ - АУСН)
- Федеральному закону № 422-ФЗ
- Актуальным ставкам взносов на 2025 год

### Тестовые сценарии

Калькулятор протестирован на:
- Граничных значениях (0 сотрудников, 5 сотрудников, 60 млн доходов)
- Типовых сценариях малого бизнеса
- Экстремальных значениях (высокие/низкие доходы и расходы)

### Известные ограничения

- Упрощённый расчёт НДС (не учитывает вычеты)
- Не учитываются региональные льготы УСН
- Не учитываются пониженные тарифы взносов
- ОСНО рассчитывается приблизительно

*Для точных расчётов рекомендуется консультация со специалистом.*

---

## Компоненты

### Calculator (главный компонент)

**Файл:** `components/calculator-ausn/Calculator.tsx`

**Ответственность:**
- Управление состоянием приложения
- Координация между формой и результатами
- Вызов функций расчёта
- Обработка действий пользователя

**Основные методы:**
- `handleCalculate()` - обработка отправки формы и расчёт
- `handleConsultation()` - открытие формы консультации
- `handleDownloadPDF()` - скачивание PDF (заглушка)
- `handleReset()` - сброс результатов

### CalculatorForm

**Файл:** `components/calculator-ausn/CalculatorForm.tsx`

**Поля формы:**
1. Тип бизнеса (RadioGroup): ИП / ООО
2. Текущая система налогообложения (Select)
3. Годовой доход (Input с форматированием)
4. Годовые расходы (Input с форматированием)
5. Количество сотрудников (Number input)
6. Средняя зарплата сотрудника (Input с форматированием)
7. Подтверждение права на АУСН (Checkbox)

**Валидация:**
- Доход > 0 и ≤ 60 млн руб.
- Расходы ≥ 0 и ≤ Доходов
- Сотрудники ≥ 0 и ≤ 5
- Зарплата > 0 (если есть сотрудники)
- Обязательное подтверждение права на АУСН

**Особенности:**
- Real-time валидация полей
- Форматирование чисел с пробелами
- Условное отображение поля зарплаты

### CalculatorResults

**Файл:** `components/calculator-ausn/CalculatorResults.tsx`

**Отображение:**
- 3 карточки результатов (текущая, АУСН 8%, АУСН 20%)
- Визуальное выделение лучшего варианта (зелёная рамка + badge)
- Детализация налогов и взносов
- Экономия/переплата с цветовым кодированием
- Кнопки действий (консультация, скачать PDF)
- Информационный блок о следующих шагах

**Форматирование:**
- Валюта: `new Intl.NumberFormat('ru-RU', { style: 'currency' })`
- Проценты: с одним знаком после запятой
- Цвета: зелёный (экономия), красный (переплата)

### ComparisonTable

**Файл:** `components/calculator-ausn/ComparisonTable.tsx`

**Структура таблицы:**
- Строки: Основной налог, Страховые взносы, Итого, Экономия
- Столбцы: Текущая система, АУСН 8%, АУСН 20%
- Детализация налогов (для ОСНО: НДФЛ/Прибыль + НДС)
- Детализация взносов (за себя + за сотрудников)
- Подсветка лучшего варианта
- Примечания внизу таблицы

### EligibilityChecker

**Файл:** `components/calculator-ausn/EligibilityChecker.tsx`

**Проверки:**
1. Годовой доход (≤ 60 млн руб.)
2. Количество сотрудников (≤ 5 чел.)
3. Регион (в списке пилотных)

**Отображение:**
- Зелёная карточка при соответствии
- Красный alert при несоответствии
- Список проверок с иконками (✓ / ✗)
- Дополнительные требования АУСН
- Список уполномоченных банков

---

## API и интеграция

### Использование в проекте

```typescript
// Импорт главного компонента
import { Calculator } from '@/components/calculator-ausn'

// Или через старый путь (совместимость)
import { Calculator } from '@/components/calculator'

// Использование
<Calculator />
```

### Экспорт функций расчёта

```typescript
import {
  calculateUSN6,
  calculateUSN15,
  calculateOSNO,
  calculateAUSN8,
  calculateAUSN20,
  checkAUSNEligibility,
  TAX_CONSTANTS,
  AUSN_CONFIG,
} from '@/components/calculator-ausn'

// Пример использования
const result = calculateAUSN8({
  revenue: 5_000_000,
  employees: 2,
  avgSalary: 50_000,
})
```

---

## Обновление данных

### Изменение налоговых ставок

**Файл:** `components/calculator-ausn/calculator-config.ts`

```typescript
// Найдите TAX_CONSTANTS и обновите нужные значения
export const TAX_CONSTANTS = {
  AUSN_INCOME_RATE: 0.08,  // Измените на новую ставку
  // ... другие константы
}
```

### Изменение лимитов АУСН

```typescript
export const AUSN_CONFIG = {
  limits: {
    maxRevenue: 60_000_000,  // Обновите лимит дохода
    maxEmployees: 5,          // Обновите лимит сотрудников
  },
}
```

### Добавление нового региона

```typescript
export const AUSN_CONFIG = {
  regions: [
    { code: '77', name: 'Москва' },
    { code: '40', name: 'Калужская область' },
    // Добавьте новый регион:
    { code: 'XX', name: 'Новый регион' },
  ],
}
```

### Обновление списка банков

```typescript
export const AUSN_CONFIG = {
  authorizedBanks: [
    {
      name: 'Название банка',
      commission: 'от 0%',
      link: 'https://bank.ru/ausn',
    },
    // Добавьте новый банк
  ],
}
```

---

## Тестирование

### Тестовые сценарии

**Тест 1: ИП на УСН 6%**
```
Тип: ИП
Текущая система: УСН "Доходы" (6%)
Доход: 2,500,000 руб.
Расходы: 0 руб.
Сотрудников: 2
Зарплата: 40,000 руб.

Ожидаемый результат:
- УСН 6%: ~150,000 руб. (с учётом уменьшения на взносы)
- АУСН 8%: ~200,000 руб.
- АУСН 20%: ~75,000 руб. (если расходы минимальны)
```

**Тест 2: ООО на ОСНО**
```
Тип: ООО
Текущая система: ОСНО
Доход: 10,000,000 руб.
Расходы: 6,000,000 руб.
Сотрудников: 5
Зарплата: 70,000 руб.

Ожидаемый результат:
- ОСНО: ~3,800,000 руб. (налог на прибыль + НДС + взносы)
- АУСН 8%: ~800,000 руб.
- АУСН 20%: ~800,000 руб. (с учётом расходов)
```

### Проверка валидации

- Доход = 0 → ошибка "Доход должен быть больше 0"
- Доход > 60 млн → ошибка "Превышен лимит АУСН"
- Расходы > Доходов → ошибка "Расходы не могут превышать доходы"
- Сотрудники > 5 → ошибка "Превышен лимит АУСН"
- Не отмечен checkbox → ошибка "Подтвердите право на АУСН"

---

## Производительность

### Оптимизация

1. **Кэширование расчётов:** Результаты сохраняются в state и не пересчитываются при повторном рендере
2. **Мемоизация:** Используется React.memo для дочерних компонентов (при необходимости)
3. **Форматирование чисел:** `Intl.NumberFormat` создаётся один раз
4. **Плавная прокрутка:** `scrollIntoView({ behavior: 'smooth' })`

### Размер бандла

Примерный размер модуля калькулятора:
- `calculator-config.ts`: ~8 KB
- `Calculator.tsx`: ~12 KB
- `CalculatorForm.tsx`: ~15 KB
- `CalculatorResults.tsx`: ~10 KB
- `ComparisonTable.tsx`: ~8 KB
- `EligibilityChecker.tsx`: ~7 KB
- **Итого:** ~60 KB (до минификации)

---

## Будущие улучшения

### Планируемые функции

1. **Экспорт в PDF:**
   - Генерация подробного отчёта
   - Красивое оформление с графиками
   - Возможность сохранения и печати

2. **История расчётов:**
   - Сохранение расчётов в localStorage
   - Просмотр истории
   - Сравнение между разными расчётами

3. **Расширенные режимы:**
   - ПСН (патентная система)
   - Региональные ставки УСН
   - Учёт налоговых льгот

4. **Аналитика:**
   - Графики динамики налоговой нагрузки
   - Прогноз на будущие периоды
   - Рекомендации по оптимизации

5. **Интеграция:**
   - Сохранение расчётов на сервере
   - Отправка на email
   - API для внешних систем

---

## Поддержка и обслуживание

### Обновление налогового законодательства

При изменении налоговых ставок или лимитов:

1. Обновите константы в `calculator-config.ts`
2. Обновите README.md в директории калькулятора
3. Обновите эту документацию
4. Добавьте запись в `docs/changelog.md`
5. Протестируйте с тестовыми данными
6. Обновите версию в `package.json`

### Мониторинг ошибок

Рекомендуется добавить Error Boundary для калькулятора:

```typescript
<ErrorBoundary fallback={<CalculatorError />}>
  <Calculator />
</ErrorBoundary>
```

### Логирование

Для отладки можно включить логирование расчётов:

```typescript
// В calculator-config.ts
const DEBUG = process.env.NODE_ENV === 'development'

if (DEBUG) {
  console.log('Расчёт УСН 6%:', result)
}
```

---

## Контакты и поддержка

При возникновении вопросов или проблем:

1. Проверьте README.md в `components/calculator-ausn/`
2. Изучите тестовые сценарии в этом документе
3. Проверьте changelog для последних изменений
4. Создайте issue в репозитории проекта

**Разработчик:** AI Assistant  
**Дата создания:** 11 октября 2025  
**Последнее обновление:** 11 октября 2025  
**Версия документации:** 1.0.0

